<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<div class="chat-wrapper">
  <div class="sidebar">
  <button class="nuevo-chat" (click)="nuevoChat()">
    <span>âž•</span> Nuevo Chat
  </button>

  <h3 class="titulo-historial">Historial de chats</h3>
  <ul class="chat-historial">
    <li *ngFor="let ses of sesiones">
      <button class="historial-item" (click)="cargarSesion(ses.session_id)">
        ðŸ•’ {{ ses.ultima_fecha | date:'MMM d, h:mm a' }}
      </button>
    </li>
  </ul>
</div>


  <div class="chat-main">
    <header class="chat-header">
      <div class="logo">
        <img src="assets/bot-icon.png" alt="bot" />
        <span><strong>Ucv</strong><span class="barra">//</span><span class="red">Bot</span></span>
      </div>

      <div class="user-menu">
        <div class="avatar" (click)="toggleMenu()">{{ iniciales }}</div>
        <div class="menu-dropdown" *ngIf="mostrarMenu">
          <button (click)="irPerfil()">
            <i class="fas fa-user-circle"></i> Perfil
          </button>
          <button (click)="cerrarSesion()">
            <i class="fas fa-sign-out-alt"></i> Salir
          </button>
        </div>
      </div>
    </header>

    <main class="chat-body">
      <h2>Hola, {{ nombreUsuario }}</h2>
      <p>Â¿En quÃ© puedo ayudarte?</p>

      <div class="botones">
        <button (click)="enviarPreguntaIA('Dame ejercicios bÃ¡sicos en Java')">Dame ejercicios bÃ¡sicos en Java</button>
        <button (click)="enviarPreguntaIA('DefiniciÃ³n de Java')">DefiniciÃ³n de Java</button>
        <button (click)="enviarPreguntaIA('Dame ejercicios de for')">Dame ejercicios de for</button>
        <button (click)="enviarPreguntaIA('Crea ejercicios de if')">Crea ejercicios de if</button>
      </div>

      <p class="nota">
        Tus conversaciones las procesan revisores humanos para mejorar la aplicaciÃ³n. No introduzcas nada que no quieras que se revise ni se utilice.
      </p>

      <!-- ðŸ§  Conversaciones -->
      <div class="mensajes">
        <div *ngFor="let msg of mensajes" [ngClass]="msg.de">
          <strong *ngIf="msg.de === 'usuario'">TÃº:</strong>
          <strong *ngIf="msg.de === 'bot'">UCVBot:</strong>
          {{ msg.texto }}
        </div>
      </div>
    </main>

    <footer class="chat-footer">
      <input
        type="text"
        placeholder="Chatea con UCVBot..."
        [(ngModel)]="nuevaPregunta"
        name="pregunta"
      />
      <button class="send-button" aria-label="Enviar" (click)="enviarPreguntaIA(nuevaPregunta)">
        <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24" fill="#ffffff">
          <path d="M2 21L23 12 2 3v7l15 2-15 2z"/>
        </svg>
      </button>
    </footer>
  </div>
</div>
